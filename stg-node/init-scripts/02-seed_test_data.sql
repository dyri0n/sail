-- =============================================================================
-- SEED_TEST_DATA.SQL - Datos de prueba para ambiente de testing
-- =============================================================================
-- Solo se ejecuta en el contenedor de testing (Dockerfile.testing)
-- =============================================================================

SET ROLE stg_admin;

SET search_path TO staging;

-- =============================================================================
-- 1. DATOS DE PRUEBA: stg_rotacion_empleados
-- =============================================================================
INSERT INTO
    stg_rotacion_empleados (
        id_personal,
        numero_personal_texto,
        id_sociedad,
        nombre_completo,
        nombre_empresa,
        area_personal,
        fecha_desde_area_personal,
        fecha_hasta_area_personal,
        unidad_organizativa,
        posicion,
        relacion_laboral,
        fecha_antiguedad_puesto,
        fecha_nacimiento,
        edad,
        pais_nacimiento,
        nacionalidad,
        estado_civil,
        numero_hijos,
        sexo,
        fecha_alta,
        fecha_baja,
        nombre_superior
    )
VALUES (
        1001,
        'EMP-1001',
        837,
        'GONZÁLEZ PÉREZ, JUAN CARLOS',
        'EMPRESA PRINCIPAL S.A.',
        'Tecnología',
        '2020-01-15',
        '9999-12-31',
        'Gerencia TI',
        'Analista Senior',
        'Indefinido',
        '2020-01-15',
        '1985-03-22',
        39,
        'Chile',
        'Chilena',
        'Casado',
        2,
        'Masculino',
        '2020-01-15',
        NULL,
        'MARTÍNEZ SILVA, ROBERTO'
    ),
    (
        1002,
        'EMP-1002',
        837,
        'RODRÍGUEZ SILVA, MARÍA FERNANDA',
        'EMPRESA PRINCIPAL S.A.',
        'Recursos Humanos',
        '2019-06-01',
        '9999-12-31',
        'Gerencia RRHH',
        'Jefe de Selección',
        'Indefinido',
        '2019-06-01',
        '1990-07-14',
        34,
        'Chile',
        'Chilena',
        'Soltera',
        0,
        'Femenino',
        '2019-06-01',
        NULL,
        'LÓPEZ MUÑOZ, CAROLINA'
    ),
    (
        1003,
        'EMP-1003',
        841,
        'MUÑOZ CONTRERAS, PEDRO ANTONIO',
        'FILIAL SERVICIOS LTDA.',
        'Operaciones',
        '2021-03-10',
        '9999-12-31',
        'Gerencia Operaciones',
        'Supervisor',
        'Indefinido',
        '2021-03-10',
        '1988-11-30',
        36,
        'Chile',
        'Chilena',
        'Casado',
        1,
        'Masculino',
        '2021-03-10',
        NULL,
        'FERNÁNDEZ CASTRO, ANDRÉS'
    ),
    (
        1004,
        'EMP-1004',
        837,
        'FERNÁNDEZ CASTRO, CAMILA ANDREA',
        'EMPRESA PRINCIPAL S.A.',
        'Finanzas',
        '2022-02-01',
        '9999-12-31',
        'Gerencia Finanzas',
        'Analista Contable',
        'Indefinido',
        '2022-02-01',
        '1995-05-18',
        29,
        'Chile',
        'Chilena',
        'Soltera',
        0,
        'Femenino',
        '2022-02-01',
        NULL,
        'VARGAS TOLEDO, MIGUEL'
    ),
    (
        1005,
        'EMP-1005',
        837,
        'SOTO VILLALOBOS, DIEGO ALEJANDRO',
        'EMPRESA PRINCIPAL S.A.',
        'Tecnología',
        '2018-09-15',
        '2024-06-30',
        'Gerencia TI',
        'Desarrollador',
        'Indefinido',
        '2018-09-15',
        '1992-01-25',
        32,
        'Chile',
        'Chilena',
        'Casado',
        1,
        'Masculino',
        '2018-09-15',
        '2024-06-30',
        'MARTÍNEZ SILVA, ROBERTO'
    );

-- =============================================================================
-- 2. DATOS DE PRUEBA: stg_capacitaciones_resumen
-- =============================================================================
INSERT INTO
    stg_capacitaciones_resumen (
        mes,
        titulo_capacitacion,
        modalidad,
        fecha_inicio,
        fecha_fin,
        area_tematica,
        tipo_formador,
        gerencia,
        formador_proveedor,
        asistentes,
        horas,
        horas_totales,
        coste_total_euros,
        valoracion_formador,
        indice_satisfaccion,
        nps
    )
VALUES (
        'Enero',
        'Excel Avanzado para Análisis de Datos',
        'PRESENCIAL',
        '2024-01-15',
        '2024-01-17',
        'HERRAMIENTAS',
        'EXTERNO',
        'RRHH',
        'Capacitaciones TechPro Ltda.',
        25,
        16,
        400,
        2500.00,
        4.5,
        92.50,
        45
    ),
    (
        'Febrero',
        'Liderazgo y Gestión de Equipos',
        'ONLINE',
        '2024-02-05',
        '2024-02-12',
        'LIDERAZGO',
        'INTERNO',
        'RRHH',
        'Departamento de Desarrollo Organizacional',
        15,
        20,
        300,
        0.00,
        4.8,
        95.00,
        60
    ),
    (
        'Marzo',
        'Normativa Laboral Actualizada 2024',
        'PRESENCIAL',
        '2024-03-20',
        '2024-03-20',
        'LEGAL',
        'EXTERNO',
        'LEGAL',
        'Abogados Asociados SpA',
        40,
        8,
        320,
        3200.00,
        4.2,
        88.00,
        35
    ),
    (
        'Abril',
        'Power BI para Reportería',
        'HIBRIDO',
        '2024-04-08',
        '2024-04-10',
        'HERRAMIENTAS',
        'EXTERNO',
        'TI',
        'DataViz Consultores',
        20,
        12,
        240,
        1800.00,
        4.6,
        91.00,
        50
    ),
    (
        'Mayo',
        'Seguridad y Salud Ocupacional',
        'PRESENCIAL',
        '2024-05-15',
        '2024-05-15',
        'SEGURIDAD',
        'INTERNO',
        'OPERACIONES',
        'Prevención de Riesgos Interno',
        60,
        4,
        240,
        0.00,
        4.0,
        85.00,
        25
    );

-- =============================================================================
-- 3. DATOS DE PRUEBA: stg_capacitaciones_participantes
-- =============================================================================
INSERT INTO
    stg_capacitaciones_participantes (
        mes,
        rut,
        id_empleado,
        nombre,
        apellidos,
        correo,
        nombre_curso,
        total_horas_formacion
    )
VALUES (
        'Enero',
        '12345678-9',
        1001,
        'JUAN CARLOS',
        'GONZÁLEZ PÉREZ',
        'jgonzalez@empresa.cl',
        'Excel Avanzado para Análisis de Datos',
        16
    ),
    (
        'Enero',
        '23456789-0',
        1002,
        'MARÍA FERNANDA',
        'RODRÍGUEZ SILVA',
        'mrodriguez@empresa.cl',
        'Excel Avanzado para Análisis de Datos',
        16
    ),
    (
        'Febrero',
        '23456789-0',
        1002,
        'MARÍA FERNANDA',
        'RODRÍGUEZ SILVA',
        'mrodriguez@empresa.cl',
        'Liderazgo y Gestión de Equipos',
        20
    ),
    (
        'Marzo',
        '34567890-1',
        1003,
        'PEDRO ANTONIO',
        'MUÑOZ CONTRERAS',
        'pmunoz@empresa.cl',
        'Normativa Laboral Actualizada 2024',
        8
    ),
    (
        'Abril',
        '12345678-9',
        1001,
        'JUAN CARLOS',
        'GONZÁLEZ PÉREZ',
        'jgonzalez@empresa.cl',
        'Power BI para Reportería',
        12
    ),
    (
        'Mayo',
        '34567890-1',
        1003,
        'PEDRO ANTONIO',
        'MUÑOZ CONTRERAS',
        'pmunoz@empresa.cl',
        'Seguridad y Salud Ocupacional',
        4
    ),
    (
        'Mayo',
        '45678901-2',
        1004,
        'CAMILA ANDREA',
        'FERNÁNDEZ CASTRO',
        'cfernandez@empresa.cl',
        'Seguridad y Salud Ocupacional',
        4
    );

-- =============================================================================
-- 4. DATOS DE PRUEBA: stg_perfiles_trabajo
-- =============================================================================
INSERT INTO
    stg_perfiles_trabajo (
        puesto,
        categoria,
        nombre_empleado,
        fecha,
        linea_ascendente,
        linea_descendente,
        principal_mision,
        responsabilidades,
        informa_y_reporta,
        tareas_semanales,
        tareas_mensuales,
        competencias
    )
VALUES (
        'Analista Senior TI',
        'Profesional',
        'GONZÁLEZ PÉREZ, JUAN CARLOS',
        '2024-01-01',
        'Jefe de Desarrollo -> Gerente TI -> Gerente General',
        'Analista Junior, Practicantes',
        'Diseñar, desarrollar y mantener soluciones tecnológicas que soporten los procesos de negocio.',
        'Análisis de requerimientos, desarrollo de software, documentación técnica, soporte nivel 3.',
        'Reporta al Jefe de Desarrollo. Informa avances en reuniones semanales de equipo.',
        'Revisión de código, reuniones de planificación, desarrollo de features.',
        'Reportes de avance, métricas de calidad, actualización de documentación.',
        'Pensamiento analítico, trabajo en equipo, comunicación efectiva, orientación a resultados.'
    ),
    (
        'Jefe de Selección',
        'Jefatura',
        'RODRÍGUEZ SILVA, MARÍA FERNANDA',
        '2024-01-01',
        'Gerente RRHH -> Gerente General',
        'Analistas de Selección (2), Asistente de RRHH',
        'Liderar los procesos de atracción y selección de talento para asegurar la incorporación de colaboradores alineados con la cultura organizacional.',
        'Diseño de procesos de selección, entrevistas, coordinación con áreas, reportes de gestión.',
        'Reporta a Gerente de RRHH. Informa KPIs de selección mensualmente.',
        'Entrevistas, revisión de CVs, coordinación de evaluaciones psicolaborales.',
        'Cierre de procesos, reporte de indicadores, actualización de perfiles de cargo.',
        'Orientación al cliente interno, comunicación, negociación, liderazgo.'
    );

-- =============================================================================
-- 5. DATOS DE PRUEBA: stg_proceso_seleccion
-- =============================================================================
INSERT INTO
    stg_proceso_seleccion (
        id_control_interno,
        fecha_cierre_proceso,
        situacion,
        motivo,
        detalle_motivo,
        publicado_portal_interno,
        fecha_envio_responsable,
        fecha_entrevista_responsable,
        duracion_entrevista_gerente,
        duracion_dias_total,
        fuente_reclutamiento,
        coste_proceso,
        n_cv_recibidos,
        n_personas_entrevistadas_telefono,
        n_personas_entrevistadas_presencial,
        n_personas_finalistas,
        puesto,
        centro_area,
        gerencia,
        linea_negocio,
        grupo,
        persona,
        sexo,
        edad,
        formacion,
        anos_experiencia,
        sector_procedencia,
        activo,
        continuidad_mas_4_meses,
        origen
    )
VALUES (
        2024001,
        '2024-02-15',
        'CERRADO - CONTRATADO',
        'Nueva posición',
        'Crecimiento del área de TI',
        TRUE,
        '2024-01-10',
        '2024-01-25',
        1.5,
        35,
        'LinkedIn',
        500.00,
        45,
        12,
        6,
        3,
        'Desarrollador Full Stack',
        'Centro TI',
        'Gerencia TI',
        'Tecnología',
        'G5',
        'TORRES VEGA, SEBASTIÁN',
        'Masculino',
        28,
        'Ingeniero Civil Informático',
        3,
        'Tecnología',
        TRUE,
        TRUE,
        'Santiago'
    ),
    (
        2024002,
        '2024-03-20',
        'CERRADO - CONTRATADO',
        'Reemplazo',
        'Renuncia voluntaria del titular',
        TRUE,
        '2024-02-20',
        '2024-03-05',
        1.0,
        28,
        'Referido interno',
        0.00,
        8,
        4,
        3,
        2,
        'Analista Contable',
        'Centro Finanzas',
        'Gerencia Finanzas',
        'Administración',
        'G4',
        'FERNÁNDEZ CASTRO, CAMILA ANDREA',
        'Femenino',
        29,
        'Contador Auditor',
        4,
        'Servicios Financieros',
        TRUE,
        TRUE,
        'Santiago'
    ),
    (
        2024003,
        NULL,
        'EN PROCESO',
        'Nueva posición',
        'Proyecto de expansión regional',
        TRUE,
        '2024-11-01',
        '2024-11-15',
        NULL,
        NULL,
        'Portal de empleo',
        150.00,
        32,
        8,
        0,
        0,
        'Supervisor de Operaciones',
        'Centro Operaciones Sur',
        'Gerencia Operaciones',
        'Operaciones',
        'G6',
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        'Concepción'
    ),
    (
        2024004,
        '2024-04-10',
        'CERRADO - DESIERTO',
        'Nueva posición',
        'Ningún candidato cumplió perfil',
        FALSE,
        '2024-03-01',
        '2024-03-25',
        2.0,
        40,
        'Headhunter',
        2500.00,
        15,
        5,
        4,
        0,
        'Gerente Comercial',
        'Corporativo',
        'Gerencia General',
        'Comercial',
        'G8',
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        FALSE,
        FALSE,
        'Nacional'
    );

RESET ROLE;